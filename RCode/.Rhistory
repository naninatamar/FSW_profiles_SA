scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)") +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))))
)
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)") +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))))
pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5))
pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)
pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2)
pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
)))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("tomato", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("dodgerblue", "seagreen"), name = "Weights") +
scale_fill_manual(values = c("dodgerblue", "seagreen"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "orange"), name = "Weights") +
scale_fill_manual(values = c("tomato", "orange"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "black"), name = "Weights") +
scale_fill_manual(values = c("tomato", "black"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "chartreuse3"), name = "Weights") +
scale_fill_manual(values = c("tomato", "chartreuse3"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
cowplot::plot_grid(plot.comb.age.rds, plot.comb.dur.rds, labels = LETTERS)
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
cowplot::plot_grid(plot.comb.age.rds, plot.comb.dur.rds, labels = LETTERS)
plot.comb.age.rds
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9))
plot.comb.age.rds
### combine the plots in one:
(plot.comb.age.rds =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(fill = "crude", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age,
aes(col = "crude", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "crude"),
alpha = 0.2) +
geom_line(data=pred.tot.age.rds,aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.rds, aes(ymin = Q0025, ymax = Q0975, fill = "rds (if available)"),
alpha = 0.3) +
geom_point(data = data.age,
aes(y = mean_age_adjusted_rds, x = study_year, size = studysize_age, col = "rds (if available)")) +
geom_ribbon(data = pred.tot.age.rds,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "rds (if available)"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5)) +
scale_color_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("tomato", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
(plot.comb.dur.rds  = pred.rate.tot %>%
ggplot(aes(x=year, y = rate_Q05)) +
geom_line(aes(col = "crude"), size = 0.8)+
geom_ribbon(aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "crude"), alpha = 0.3) +
theme_bw() +
labs(y = "Mean duration (95%-CrI) of sex work [years]", x = "Study year") +
scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015, 2019)) +
geom_ribbon(aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="crude"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted, x = study_year, size = studysize_duration, col = "crude")) +
theme(legend.position = "none") +
scale_size_continuous(range = c(0.5, 5)) +
scale_y_continuous(breaks =c(2.5, 5, 7.5, 10, 12.5 ,15, 17.5)) +
geom_line(data = pred.rate.tot.rds, aes(col = "rds (if available)"), size = 0.8, lty = 2)+
geom_ribbon(data= pred.rate.tot.rds, aes(ymin = rate_Q0025, ymax = rate_Q0975, fill = "rds (if available)"), alpha = 0.3) +
geom_ribbon(data = pred.rate.tot.rds, aes(ymin = rate_Q0025_re, ymax = rate_Q0975_re, fill ="rds (if available)"), alpha = 0.2) +
geom_point(data = data.duration, aes(y = mean_duration_adjusted_rds, x = study_year, size = studysize_duration, col = "rds (if available)")) +
scale_color_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
scale_fill_manual(values = c("dodgerblue", "chartreuse4"), name = "Weights") +
guides(size = FALSE) +
theme(legend.position = c(0.15, 0.9)))
cowplot::plot_grid(plot.comb.age.rds, plot.comb.dur.rds, labels = LETTERS)
(plot.comb =  pred.tot.age %>%
ggplot(aes(x=year, y = Q05)) +
geom_line(aes(col = "10"), size = 0.8)+
geom_ribbon(aes(fill = "10", ymin = Q0025, ymax = Q0975),
alpha = 0.3) +
theme_bw() +
labs(y = "Mean age (95% CrI) of female sex workers [years]", x = "Study year") +
geom_point(data = data.age.incl15,
aes(col = "10", y = mean_age_adjusted, x = study_year, size = studysize_age)) +
geom_ribbon(data = pred.tot.age,
aes(ymin = Q0025_re, ymax = Q0975_re, fill = "10"),
alpha = 0.2) +
geom_line(data=pred.tot.age.15,aes(col = "15"), size = 0.8, lty = 2)+
geom_ribbon(data = pred.tot.age.15, aes(ymin = Q0025, ymax = Q0975, fill = "15"),
alpha = 0.3) +
geom_point(data = data.age.incl15,
aes(y = mean_age_adjusted_15, x = study_year, size = studysize_age, col = "15")) +
geom_ribbon(data = pred.tot.age.15,
aes(ymin = Q0025_re, ymax = Q0975_re, fill =  "15"),
alpha = 0.2) +
scale_size_continuous(range= c(0.1,5))) +
scale_color_manual(values = c("tomato", "seagreen"), name = "offset [years]") +
scale_fill_manual(values = c("tomato", "seagreen"), name = "offset [years]") +
guides(size = FALSE) +
theme(legend.position = c(0.1, 0.9))
sum(data.age$rds_weights_avail)
length(unique(data.age$Study[data.age$rds_weights_avail]))
(unique(data.age$Study[data.age$rds_weights_avail]))
data.age %>% fitler(rds_weights_avail)
data.age %>% filter(rds_weights_avail)
data.age %>% filter(rds_weights_avail == 1)
(unique(data.age$Study[data.age$rds_weights_avail == 1]))
